(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[38],{2337:function(s,t,a){"use strict";a.r(t);var e=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("q-scroll-area",{staticClass:"full-height full-width"},[a("div",{staticClass:"q-pa-lg"},[a("div",{staticClass:"row q-mb-md"},[a("div",{staticClass:"col text-h5"},[s._v(s._s(s.$t("STANDARDAUTHWEBCLIENT.USER_SETTINGS_TAB_HEADING")))])]),a("q-card",{staticClass:"card-edit-settings",attrs:{flat:"",bordered:""}},[a("q-card-section",[a("div",{staticClass:"row q-pb-md"},[a("div",{staticClass:"col-2"},[a("div",{staticClass:"q-my-sm"},[s._v("\n              "+s._s(s.$t("COREWEBCLIENT.LABEL_LOGIN"))+"\n            ")])]),a("div",{staticClass:"col-5"},[a("q-input",{staticClass:"q-ml-sm",attrs:{outlined:"",dense:"","bg-color":"white",disable:""},model:{value:s.login,callback:function(t){s.login=t},expression:"login"}})],1)]),a("div",{staticClass:"row q-pb-md"},[a("div",{staticClass:"col-2"},[a("div",{staticClass:"q-my-sm"},[s._v("\n              "+s._s(s.$t("COREWEBCLIENT.LABEL_PASSWORD"))+"\n            ")])]),a("div",{staticClass:"col-5"},[a("q-input",{ref:"password",staticClass:"q-ml-sm",attrs:{outlined:"",dense:"","bg-color":"white",type:"password",autocomplete:"new-password"},model:{value:s.password,callback:function(t){s.password=t},expression:"password"}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-2"},[a("div",{staticClass:"q-my-sm"},[s._v("\n              "+s._s(s.$t("STANDARDAUTHWEBCLIENT.LABEL_CONFIRM_PASS"))+"\n            ")])]),a("div",{staticClass:"col-5"},[a("q-input",{ref:"confirmPassword",staticClass:"q-ml-sm",attrs:{outlined:"",dense:"","bg-color":"white",type:"password",autocomplete:"new-password"},model:{value:s.confirmPassword,callback:function(t){s.confirmPassword=t},expression:"confirmPassword"}})],1)])])],1),s.hasAccount?s._e():a("div",{staticClass:"q-pt-md text-right"},[a("q-btn",{staticClass:"q-px-sm",attrs:{unelevated:"","no-caps":"",dense:"",ripple:!1,color:"primary",label:s.$t("COREWEBCLIENT.ACTION_SAVE")},on:{click:s.createSettingsForEntity}})],1),s.hasAccount?a("div",{staticClass:"q-pt-md text-right"},[a("q-btn",{staticClass:"q-px-sm",attrs:{unelevated:"","no-caps":"",dense:"",ripple:!1,color:"primary",label:s.$t("COREWEBCLIENT.ACTION_SAVE")},on:{click:s.updateSettingsForEntity}})],1):s._e()],1),s._l(s.additionalComponents,(function(t){return a(t,{key:t.name,tag:"component",attrs:{user:s.user,loading:s.loading}})})),a("q-inner-loading",{staticStyle:{"justify-content":"flex-start"},attrs:{showing:s.loading||s.saving}},[a("q-linear-progress",{attrs:{query:""}})],1)],2)},n=[],i=a("6374"),o=a.n(i),r=a("c973"),d=a.n(r),c=(a("fb17"),a("b771"),a("192a"),a("b2f5")),l=a.n(c),u=a("4245"),p=a("21ac"),h=a("6bfe"),v=a("e539"),E=a("11cb"),m=a("81f6"),f="     ",C={name:"DbAdminSettingsPerUser",data:function(){return{user:null,password:"",savedPass:"",savedConfirmPass:"",confirmPassword:"",login:"",loading:!1,saving:!1,hasAccount:!1,additionalComponents:[]}},watch:{$route:function(s,t){this.parseRoute()}},mounted:function(){var s=this;return d()(regeneratorRuntime.mark((function t(){var a,e,n,i,r,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s.parseRoute(),a={components:[]},m["a"].$emit("DbAdminSettingsPerUser::GetAdditionalComponents",a),e=[],n=o()(a.components),t.prev=5,n.s();case 7:if((i=n.n()).done){t.next=15;break}return r=i.value,t.next=11,r;case 11:d=t.sent,null!==d&&void 0!==d&&d.default&&e.push(d.default);case 13:t.next=7;break;case 15:t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](5),n.e(t.t0);case 20:return t.prev=20,n.f(),t.finish(20);case 23:s.additionalComponents=e;case 24:case"end":return t.stop()}}),t,null,[[5,17,20,23]])})))()},beforeRouteLeave:function(s,t,a){this.doBeforeRouteLeave(s,t,a)},methods:{hasChanges:function(){return this.password!==this.savedPass||this.savedConfirmPass!==this.confirmPassword},revertChanges:function(){this.password=this.savedPass,this.confirmPassword=this.savedConfirmPass},isDataValid:function(){var s=l.a.trim(this.password);return""===s?(p["a"].showError(this.$t("COREWEBCLIENT.ERROR_REQUIRED_FIELDS_EMPTY")),this.$refs.password.focus(),!1):s===l.a.trim(this.confirmPassword)||(p["a"].showError(this.$t("COREWEBCLIENT.ERROR_PASSWORDS_DO_NOT_MATCH")),this.$refs.confirmPassword.focus(),!1)},parseRoute:function(){var s,t,a,e=h["a"].pPositiveInt(null===(s=this.$route)||void 0===s||null===(t=s.params)||void 0===t?void 0:t.id);(null===(a=this.user)||void 0===a?void 0:a.id)!==e&&(this.user={id:e},this.populate())},populate:function(){var s=this;this.loading=!0;var t=this.$store.getters["tenants/getCurrentTenantId"];E["a"].getUser(t,this.user.id).then((function(t){var a=t.user,e=t.userId;s.loading=!1,e===s.user.id&&(a&&l.a.isFunction(null===a||void 0===a?void 0:a.getData)?(s.user=a,s.login=a.getData("PublicId"),s.getUserAccounts()):s.$emit("no-user-found"))}))},updateSettingsForEntity:function(){var s=this;if(!this.saving&&this.isDataValid()){var t;this.saving=!0;var a={AccountId:null===(t=this.account)||void 0===t?void 0:t.id,TenantId:this.user.tenantId,Password:this.password};v["a"].sendRequest({moduleName:"StandardAuth",methodName:"UpdateAccount",parameters:a}).then((function(t){s.saving=!1,t?(s.savedPass=s.password,s.savedConfirmPass=s.password,s.populate(),p["a"].showReport(s.$t("COREWEBCLIENT.REPORT_SETTINGS_UPDATE_SUCCESS"))):p["a"].showError(s.$t("COREWEBCLIENT.ERROR_SAVING_SETTINGS_FAILED"))}),(function(t){s.saving=!1,p["a"].showError(u["a"].getTextFromResponse(t,s.$t("COREWEBCLIENT.ERROR_SAVING_SETTINGS_FAILED")))}))}},createSettingsForEntity:function(){var s=this;if(!this.saving&&this.isDataValid()){this.saving=!0;var t={Login:this.login,TenantId:this.user.tenantId,Password:this.password};v["a"].sendRequest({moduleName:"StandardAuth",methodName:"CreateAuthenticatedUserAccount",parameters:t}).then((function(t){s.saving=!1,t?(s.savedPass=s.password,s.savedConfirmPass=s.password,s.populate(),p["a"].showReport(s.$t("COREWEBCLIENT.REPORT_SETTINGS_UPDATE_SUCCESS"))):p["a"].showError(s.$t("COREWEBCLIENT.ERROR_SAVING_SETTINGS_FAILED"))}),(function(t){s.saving=!1,p["a"].showError(u["a"].getTextFromResponse(t,s.$t("COREWEBCLIENT.ERROR_SAVING_SETTINGS_FAILED")))}))}},getUserAccounts:function(){var s,t,a=this;this.loading=!0;var e={UserId:null===(s=this.user)||void 0===s?void 0:s.id,TenantId:null===(t=this.user)||void 0===t?void 0:t.tenantId};v["a"].sendRequest({moduleName:"StandardAuth",methodName:"GetUserAccounts",parameters:e}).then((function(s){a.loading=!1,s.length?(a.confirmPassword||(a.password=f,a.savedPass=f),a.hasAccount=!0,a.account=s.find((function(s){return s.login===a.user.publicId}))):a.hasAccount=!1,a.loading=!1}))}}},g=C,w=a("2877"),R=a("4983"),I=a("f09f"),S=a("a370"),A=a("27f9"),T=a("9c40"),_=a("74f7"),N=a("6b1d"),P=a("eebe"),b=a.n(P),L=Object(w["a"])(g,e,n,!1,null,null,null);t["default"]=L.exports;b()(L,"components",{QScrollArea:R["a"],QCard:I["a"],QCardSection:S["a"],QInput:A["a"],QBtn:T["a"],QInnerLoading:_["a"],QLinearProgress:N["a"]})}}]);