(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"/mP0":function(e,t,n){"use strict";(function(t){e.exports=function(e){var a=n("0h2I"),o=n("IAk5"),i=n("RN+F"),s=n("aWeh"),r=n("ZCBP"),h=[],c=null;s.init(e);var u=s.AppName?i.getUrlFriendlyName(s.AppName):s.HashModuleName;if(o.isUserNormalOrTenant()){var l={getScreens:function(){var e={};return e[s.HashModuleName]=function(){return n("Ik4g")},e}};return o.isNewTab()||(l.start=function(e){n("SQrT").initHiddenView(s.HashModuleName),""!==s.ChatUrl&&e.run("SettingsWebclient","registerSettingsTab",[function(){return n("5K20")},s.HashModuleName,i.i18n("ROCKETCHATWEBCLIENT/LABEL_SETTINGS_TAB")]),o.subscribeEvent("Logout",(function(){t.removeCookie("RocketChatAuthToken"),t.removeCookie("RocketChatUserId"),t("#rocketchat_iframe")&&(t("#rocketchat_iframe").hide(),t("#rocketchat_iframe").get(0).contentWindow.postMessage({externalCommand:"logout"},"*"))})),""!==s.ChatUrl&&o.subscribeEvent("ContactsWebclient::AddCustomCommand",(function(e){e.Callback({Text:i.i18n("ROCKETCHATWEBCLIENT/ACTION_CHAT_WITH_CONTACT"),CssClass:"chat",Handler:function(){var e=h[this.uuid()];if(e&&!e.closed)e.focus();else{var t=window.screen.width,n=Math.ceil((t-360)/2),a=window.screen.height,o=Math.ceil((a-600)/2),i="?chat-direct="+this.uuid()+"&"+(new Date).getTime(),s=",width=360,height=600,top="+o+",left="+n;(e=r.open(i,"Chat",!1,s))&&(h[this.uuid()]=e)}},Visible:a.computed((function(){return e.Contact.team()&&!e.Contact.itsMe()}))})}))},l.getHeaderItem=function(){if(null===c&&(c=n("Eh7V")),""!==s.ChatUrl)return{item:c,name:u}}),l}return null}}).call(this,n("EVdn"))},"5K20":function(e,t,n){"use strict";n("F/us"),n("EVdn"),n("0h2I");var a=n("IAk5"),o=n("JNg6"),i=n("RN+F"),s=n("aWeh"),r=n("hPb3");function h(){this.sAppName=s.AppName||i.i18n("ROCKETCHATWEBCLIENT/LABEL_SETTINGS_TAB"),this.server=s.ChatUrl,this.bDemo=r.IsDemo,this.sDownloadLink="https://rocket.chat/install/#Apps",this.credentialsHintText=a.mobileCredentialsHintText}h.prototype.getLoginForCurrentUser=function(){o.send("GetLoginForCurrentUser",{},(function(e){this.sLogin(e.Result)}),this)},h.prototype.ViewTemplate="RocketChatWebclient_RocketChatSettingsPaneView",e.exports=new h},Eh7V:function(e,t,n){"use strict";var a=n("F/us"),o=n("0h2I"),i=n("RN+F"),s=n("AFLV"),r=n("JNg6"),h=n("Ig+v"),c=n("ZCBP");function u(){h.call(this,i.i18n("ROCKETCHATWEBCLIENT/ACTION_SHOW_CHAT")),this.iAutoCheckMailTimer=-1,this.unseenCount=o.observable(0),this.mainHref=o.computed((function(){return this.hash()}),this),this.getUnreadCounter()}u.prototype.getUnreadCounter=function(){r.send("GetUnreadCounter",{},(function(e){this.unseenCount(s.pInt(e.Result))}),this)},u.prototype.onChatClick=function(e,t){c.open("?chat","Chat")},a.extendOwn(u.prototype,h.prototype),u.prototype.ViewTemplate="RocketChatWebclient_HeaderItemView";var l=new u;l.allowChangeTitle(!0),e.exports=l},"Ig+v":function(e,t,n){var a=n("0h2I"),o=n("QaF5");function i(e){this.sName="",this.visible=a.observable(!0),this.baseHash=a.observable(""),this.hash=a.observable(""),this.linkText=a.observable(e),this.isCurrent=a.observable(!1),this.recivedAnim=a.observable(!1).extend({autoResetToFalse:500}),this.unseenCount=a.observable(0),this.allowChangeTitle=a.observable(!1),this.inactiveTitle=a.observable(""),this.excludedHashes=a.observableArray([])}i.prototype.ViewTemplate="CoreWebclient_HeaderItemView",i.prototype.setName=function(e){this.sName=e.toLowerCase(),""===this.baseHash()?(this.hash(o.buildHashFromArray([e.toLowerCase()])),this.baseHash(this.hash())):this.hash(this.baseHash())},e.exports=i},Ik4g:function(e,t,n){"use strict";var a=n("F/us"),o=n("0h2I"),i=n("AFLV"),s=n("Yjhd"),r=n("xcwT"),h=n("QaF5"),c=n("hPb3"),u=n("aWeh");function l(){r.call(this,"RocketChatWebclient"),this.sChatUrl=u.ChatUrl,this.iframeDom=o.observable(null),this.avaDom=o.observable(null)}a.extendOwn(l.prototype,r.prototype),l.prototype.ViewTemplate="RocketChatWebclient_MainView",l.prototype.ViewConstructorName="CMainView",l.prototype.setAuroraThemeToRocketChat=function(e){function t(){e.contentWindow.postMessage({externalCommand:"set-aurora-theme",theme:c.Theme},"*")}setTimeout(t,500),setTimeout(t,1e3),setTimeout(t,2e3)},l.prototype.onLoad=function(){this.iframeDom()&&this.iframeDom().length>0&&(this.iframeDom()[0].contentWindow.postMessage({externalCommand:"login-with-token",token:u.ChatAuthToken},"*"),this.setAuroraThemeToRocketChat(this.iframeDom()[0]),window.addEventListener("message",function(e){(e&&e.data&&"notification"===e.data.eventName&&this.showNotification(e.data.data.notification),e&&e.data&&"unread-changed"===e.data.eventName)&&n("Eh7V").unseenCount(i.pInt(e.data.data))}.bind(this)))},l.prototype.showNotification=function(e){var t={action:"show",icon:this.sChatUrl+"avatar/"+e.payload.sender.username+"?size=50&format=png",title:e.title,body:e.text,callback:function(){window.focus(),this.shown()||h.setHash([u.HashModuleName]);var t="";switch(e.payload.type){case"c":t="/channel/"+e.payload.name;break;case"d":t="/direct/"+e.payload.rid;break;case"p":t="/group/"+e.payload.name}t&&this.iframeDom()[0].contentWindow.postMessage({externalCommand:"go",path:t},"*")}.bind(this)};s.desktopNotify(t)},e.exports=new l},JNg6:function(e,t,n){"use strict";var a=n("o0Bx"),o=n("aWeh");e.exports={send:function(e,t,n,i,s){a.send(s||o.ServerModuleName,e,t,n,i)}}},aWeh:function(e,t,n){"use strict";var a=n("F/us"),o=n("AFLV");e.exports={ServerModuleName:"RocketChatWebclient",HashModuleName:"chat",ChatUrl:"",ChatAuthToken:"",UnreadCounterIntervalInSeconds:15,init:function(e){var t=e.RocketChatWebclient;a.isEmpty(t)||(this.ChatUrl=o.pString(t.ChatUrl),this.ChatAuthToken=o.pString(t.ChatAuthToken),this.UnreadCounterIntervalInSeconds=o.pInt(t.UnreadCounterIntervalInSeconds,this.UnreadCounterIntervalInSeconds))}}}}]);